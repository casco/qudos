---
layout: '@layouts/math.astro'
title: Algoritmo de Grover
description: Un análisis profundo sobre el algoritmo de Grover, su funcionamiento, componentes y cómo acelera la búsqueda en conjuntos no estructurados mediante técnicas cuánticas.
head:
  - tag: meta
    attrs:
      { property: 'og:image', content: /qudos/grover/grover-algorithm.png }
  - tag: meta
    attrs:
      { property: 'og:image:alt', content: 'Algoritmo de Grover en un circuito cuántico utilizando la amplificación de amplitudes.' }
---

import { Image } from 'astro:assets'
import { Aside, Card, Code, Tabs, TabItem } from '@astrojs/starlight/components'
import Box from '@components/Box.astro'
import Circle from '@components/CircleNotation.astro'
import QuantumCircuit from '@components/QuantumCircuit.astro'
import BibItem from '@components/BibItem.astro'
import Recommendations from '@components/Recommendations.astro'
import ResourceDivider from '@components/ResourceDivider.astro'
import {
  quirk_example,
  qiskit_example,
  qiskit_example_result
} from '@code-snippets/grover'


El algoritmo de Grover es el algoritmo de búsqueda cuántico por excelencia, ya que permite encontrar un elemento dentro de un conjunto de elementos no estructurado. Es muy importante porque puede aplicarse sobre diferentes clases de problemas y acelerar los algoritmos clásicos que usan heurísticas de búsqueda. 

## Objetivo

Dada una base de datos no ordenada de $N$ elementos, de la cual sólo uno de ellos satisface una propiedad en particular, se quiere encontrar dicho elemento. El mejor algoritmo clásico conocido realiza esta tarea en $O(N)$ pasos, mientras que este algoritmo puede resolverlo en $O(\sqrt{N})$ pasos.

## Oráculo 

Se desea buscar sobre un espacio de búsqueda de $N$ elementos. En lugar de buscar dichos elementos directamente, se pondrá el foco sobre su índice,
el cual puede enumerarse desde $0$ hasta $N - 1$. Se asumirá $N = 2^n$, de manera que el índice pueda ser almacenado en $n$ bits, y el problema tendrá exactamente 
$1$ solución. Una instancia del problema de búsqueda puede ser representada por una función $\chi$, que toma un entero $x$ como entrada dentro 
del rango que va desde $0$ hasta $N - 1$. Por definición, $\chi(x) = 1$ si $x$ es la solución del problema, y $\chi(x) = 0$ en caso contrario.

La función $\chi$ antes definida se asume implementada por medio de un oráculo cuántico con la habilidad para reconocer soluciones al problema de búsqueda. 
Precisamente, se trata de un <a href={`${import.meta.env.BASE_URL}/concepts/oracles#oráculo-de-fase`}>oráculo de fase</a>, encargado de marcar las soluciones del problema de búsqueda, modificando su fase. En este artículo se llamará $O$ a la aplicación de dicho oráculo.

## Solución

Los pasos llevados a cabo en este algoritmo se corresponden con la metodología general de la <a href={`${import.meta.env.BASE_URL}/primitives/amplitude-amplification`}>amplificación de amplitudes (AA)</a>, implementada de manera específica para el problema planteado en este artículo. Se recomienda ver la explicación completa de dicha primitiva y luego volver para comprender su aplicación sobre el algoritmo de Grover. Cabe aclarar que, a diferencia de lo expuesto en AA, el circuito utilizará un cubit auxiliar adicional para implementar el oráculo de fase.

### Preparación

El programa comienza en el estado $\ket{0}^{\otimes n}$ (ignorando cubits auxiliares). El algoritmo de Grover recurre a la superposición $\mathcal{A} = H$, aplicando la transformación de Hadamard para alcanzar un estado de superposición uniforme sobre todas las soluciones en el espacio de búsqueda. 

```math
\ket{\Psi} = \mathcal{A}\ket{0} = H\ket{0} = \frac{1}{\sqrt N} \sum_{0}^{N - 1}\ket{x}
```

### Selección 

Para seleccionar el único estado bueno y negar su fase se utiliza el oráculo $O$, que tiene la capacidad de reconocer la solución al problema. En términos de <a href={`${import.meta.env.BASE_URL}/primitives/amplitude-amplification#selección`}>AA</a>, $S_{\chi} = O$.

### Reflejo

Se produce a efectos de la puerta Hadamard ya que se trabaja con superposiciones uniformes.

### Iteración 

Las iteraciones de Grover son comprendidas por las etapas de **selección** y **reflejo**. Sea $S_{\chi} = O$, $\mathcal{A} = H$ y $\mathcal{A}^\dag = H$ debido a que la transformación de Hadamard es su propia inversa. En términos de <a href={`${import.meta.env.BASE_URL}/primitives/amplitude-amplification#selección`}>AA</a>, las iteraciones de Grover constituyen la aplicación del siguiente operador $Q$:

```math
Q = -H S_0 H O
```

{/*

A continuación, el algoritmo de búsqueda consiste en la aplicación reiterada de una subrutina cuántica, conocida como iteración de Grover, que es representada mediante la letra $G$ y consta de los siguientes pasos:

1. Etapa de **selección**. Llevada a cabo mediante la aplicación del oráculo O. 
2. Etapa de **reflejo**. Debido a que en este problema se tratan superposiciones uniformes, se aplican los siguientes pasos:
- Aplicar la transformación de Hadamard $H^{\otimes n}$
- Realizar un cambio de fase condicional, con todos los estados a excepción de $\ket{0}$ recibiendo un cambio de fase con valor $-1$,
```math
\ket{x} \rightarrow -(-1)^{\delta_{x0}} \ket{x}
```
- Aplicar la transformación de Hadamard $H^{\otimes n}$

*Nota: el operador unitario correspondiente al cambio de fase es $2\ket{0}\bra{0} - I$.*

El efecto de la etapa de **reflejo** se encuentra desarrollado a continuación.

```math
\begin{align}
H^{\otimes n}(2\ket{0}\bra{0} - I)H^{\otimes n}&=\\
2(H^{\otimes n}\ket{0}\bra{0}H^{\otimes n}) - I&=\\
2\ket{u}\bra{u} - I
\end{align}
```

Debido a que aplicar $H^{\otimes n}$ da como resultado una superposición uniforme $u$.

Así, la iteración de Grover $G$ puede escribirse de la siguiente manera:

```math
G = (2\ket{u}\bra{u} - I)O
```

En términos de la <a href={`${import.meta.env.BASE_URL}/primitives/amplitude-amplification`}>amplificación de amplitudes</a>, $\mathcal{A} = H$, ya que se aplica una superposición uniforme para todos los elementos sobre el estado inicial $\ket{0}$. Además, $S_\chi = O$, debido a que la distinción de la solución es empleada por medio del oráculo previamente definido. Así, el operador $Q$ toma la siguiente forma:

```math 
Q = -HS_0HO
```

*/}

## Complejidad

Dado que la probabilidad inicial de éxito $a$ es exactamente $\frac{1}{N}$ (existe una única solución al problema), si se mide luego de $m = \left\lfloor \frac{\pi}{4} \sqrt{N} \right\rfloor$ iteraciones de $Q$, la probabilidad de encontrar la solución tiene una cota inferior de $1 - \frac{1}{N}$. Ver detalles en <a href={`${import.meta.env.BASE_URL}/primitives/amplitude-amplification#complejidad#solución-única`}>AA</a>.

## Circuito

<div style='display:flex; justify-content:center; align-items:center; flex-direction:column'>
  <Image
    src={`${import.meta.env.BASE_URL}/grover/grover-algorithm.png`}
    alt='Algoritmo de Grover en un circuito cuántico utilizando la iteración de Grover G.'
    width='750'
    height='300'
  />
  <span style='width:700px; padding:10px 40px'>
    **Figura (1):** Algoritmo de Grover en un circuito cuántico utilizando la iteración de Grover $Q$.
  </span>
</div>

<div style='display:flex; justify-content:center; align-items:center; flex-direction:column'>
  <Image
    src={`${import.meta.env.BASE_URL}/grover/grover-iteration.png`}
    alt='Iteración de Grover G en un circuito cuántico.'
    width='600'
    height='200'
  />
  <span style='width:700px; padding:10px 40px'>
    **Figura (2):** Iteración de Grover Q en un circuito cuántico. "In" representa el estado del registro de búsqueda, mientras que "aux" es el cubit auxiliar usado por el oráculo de fase.
  </span>
</div>

{/*
#### Comportamiento

Para evaluar el comportamiento del algoritmo se definirán dos conjuntos de cadenas.

```math 
A_0 = \{x \in \Sigma^n: f(x) = 0\}\\
A_1 = \{x \in \Sigma^n: f(x) = 1\}
```

El conjunto $A_1$ contiene todas las soluciones del problema de búsqueda, mientras que $A_0$ contiene aquellas cadenas que no son soluciones.
Ambos conjuntos satisfacen $A_0 \cap A_1 = \varnothing$ y $A_0 \cup A_1 = \Sigma^n$, lo cual significa que $A_0$ y $A_1$ constituyen una bipartición de $\Sigma^n$.

Además, se definirán dos vectores unitarios que representan las superposiciones uniformes sobre los conjuntos previamente tratados.

```math 
\ket{A_0} = \frac{1}{\sqrt{|A_0|}} \sum_{x \in A_0} \ket{x}\\
\ket{A_1} = \frac{1}{\sqrt{|A_1|}} \sum_{x \in A_1} \ket{x}
```

Notar que estos vectores se encuentran definidos únicamente cuando ninguno de los conjuntos es vacío.
Haciendo uso nuevamente de $\ket{u}$ para referir al estado cuántico uniforme sobre las cadenas de $n$ bits:

```math 
\ket{u} = \frac{1}{\sqrt N} \sum_{x \in \Sigma^n} \ket{x}
```

Esto puede representarse también como:

```math 
\ket{u} = \sqrt{\frac{|A_0|}{N}} \ket{A_0} + \sqrt{\frac{|A_1|}{N}} \ket{A_1}
```

Recordar que también se cumple $\ket{u} = H^{\otimes n}\ket{0^n}$, de manera que $\ket{u}$ representa el estado del registro $Q$ tras realizar la etapa de **preparación** del algoritmo de Grover. Esto implica que justo antes de alcanzar la etapa de **selección**, el estado de $Q$ se encuentra contenido en un espacio vectorial de dos dimensiones abarcado por $\ket{A_0}$ y $\ket{A_1}$, y los coeficientes de ambos vectores son números reales. Notar que $Q$ siempre tendrá esta propiedad luego de cualquier cantidad de iteraciones de $G$ en el primer paso de la etapa de **reflexión**.

Otro punto importante a considerar es que el algoritmo de Grover no se preocupa sobre cuáles cadenas son soluciones, solamente debe ser capaz de distinguirlas respecto de aquellas cadenas que no lo son.

Al aplicar $G$ sobre $\ket{A_0}$ se obtiene:

```math
\frac{|A_0| - |A_1|}{N} \ket{A_0} + 2\frac{\sqrt{|A_1|\cdot|A_0|}}{N} \ket{A_1}
```

Mientras que aplicar $G$ sobre $\ket{A_1}$ produce:

```math
-2\frac{\sqrt{|A_0| \cdot |A_1|}}{N} \ket{A_0} + \frac{|A_0| - |A_1|}{N} \ket{A_1}
```

Por conveniencia, se expresará la acción de $G$ en un espacio de dos dimensiones como una matriz.

```math 
M = 
\begin{pmatrix}
\frac{|A_0| - |A_1|}{N}&-2\frac{\sqrt{|A_0||A_1|}}{N}\\
2\frac{\sqrt{|A_0||A_1|}}{N}&\frac{|A_0| - |A_1|}{N}\\
\end{pmatrix}
```

donde la primera y segunda fila/columna corresponden a $\ket{A_0}$ y $\ket{A_1}$ respectivamente. Dicha matriz $M$ se obtiene al multiplicar 
por sí misma una matriz más simple.

```math
M = 
\begin{pmatrix}
\sqrt{\frac{|A_0|}{N}}&-\sqrt{\frac{|A_1|}{N}}\\
\sqrt{\frac{|A_1|}{N}}&\sqrt{\frac{|A_0|}{N}}\\
\end{pmatrix}^2
```

Además, la matriz 

```math
\begin{pmatrix}
\sqrt{\frac{|A_0|}{N}}&-\sqrt{\frac{|A_1|}{N}}\\
\sqrt{\frac{|A_1|}{N}}&\sqrt{\frac{|A_0|}{N}}\\
\end{pmatrix}
```

es de rotación, la cual puede expresarse como 

```math
\begin{pmatrix}
cos(\theta)&-sin(\theta)\\
sin(\theta)&cos(\theta)\\
\end{pmatrix}
```

para $\theta = sin^{-1}\left(\sqrt{\frac{|A_1|}{N}}\right)$. Utilizando esta nueva expresión para $M$:

```math
\begin{align}
  M =& 
  \begin{pmatrix}
    cos(\theta)&-sin(\theta)\\
    sin(\theta)&cos(\theta)\\
  \end{pmatrix}^2\\

  =& 
  \begin{pmatrix}
    cos^2(\theta)-sin^2(\theta)&-cos(\theta)sin(\theta) - cos(\theta)sin(\theta)\\
    cos(\theta)sin(\theta) + cos(\theta)sin(\theta)&cos^2(\theta) - sin^2(\theta)\\
  \end{pmatrix}^2\\

  =& 
  \begin{pmatrix}
    cos^2(\theta)-sin^2(\theta)&-2cos(\theta)sin(\theta)\\ 
    2cos(\theta)sin(\theta)&cos^2(\theta) - sin^2(\theta)\\
  \end{pmatrix}^2
\end{align}
```

Otra igualdad que se puede alcanzar sin hacer cálculos es

```math
M = 
\begin{pmatrix}
  cos(\theta)&-sin(\theta)\\
  sin(\theta)&cos(\theta)
\end{pmatrix}^2 = 
\begin{pmatrix}
  cos(2\theta)&-sin(2\theta)\\
  sin(2\theta)&cos(2\theta)
\end{pmatrix} 
```

ya que rotar por el ángulo $\theta$ dos veces es equivalente a rotar por el ángulo $2\theta$.

Retomando, el estado del registro $Q$ al comienzo del paso de la iteración de Grover es 

```math 
\ket{u} = \sqrt{\frac{|A_0|}{N}} \ket{A_0} + \sqrt{\frac{|A_1|}{N}} \ket{A_1} = cos(\theta) \ket{A_0} + sin(\theta) \ket{A_1}
```

y el efecto de aplicar $G$ sobre dicho estado consiste en aplicar una rotación por el ángulo $2\theta$ dentro del espacio abarcado por $\ket{A_0}$ y $\ket{A_1}$.

Por ejemplo: 

```math 
G^1\ket{u} = cos(3\theta) \ket{A_0} + sin(3\theta) \ket{A_1}\\
G^2\ket{u} = cos(5\theta) \ket{A_0} + sin(5\theta) \ket{A_1}\\
G^3\ket{u} = cos(7\theta) \ket{A_0} + sin(7\theta) \ket{A_1}
```

Regla general:

```math 
G^k\ket{u} = cos((2k+1)\theta) \ket{A_0} + sin((2k+1)\theta) \ket{A_1}
```

La idea es que la iteración de Grover rote el estado vectorial hacia $\ket{A_1}$. Cuando esto ocurre, una medición del estado produce con alta probabilidad 
una de las salidas superpuestas en $\ket{A_1}$, es decir, una solución al problema.

Inicialmente el estado vectorial es ortogonal respecto de $\ket{A_1}$. Partiendo de este punto, la operación del oráculo $O$ refleja el estado en torno a $\ket{A_0}$, y luego la operación $2\ket{u}\bra{u} - I$ lo refleja en torno a $\ket{u}$. Dado que dos reflexiones producen una rotación, el vector de estado se acerca hacia $\ket{A_1}$, y luego de reiteradas rotaciones es posible obtener una solución con alta probabilidad mediante una observación en la base computacional.

<div style='display:flex; justify-content:center; align-items:center; flex-direction:column'>
  <Image
    src={`${import.meta.env.BASE_URL}/grover/reflection1.jpg`}
    alt='Reflexión realizada al aplicar el oráculo O respecto del estado ortogonal $\ket{A_0}$.'
    width='700'
    height='700'
  />
  <span style='width:455px; padding:10px 40px'>
    **Figura (3):** Reflexión realizada al aplicar el oráculo O respecto del estado ortogonal $\ket{A_0}$.
  </span>
</div>

<div style='display:flex; justify-content:center; align-items:center; flex-direction:column'>
  <Image
    src={`${import.meta.env.BASE_URL}/grover/reflection2.jpg`}
    alt='Reflexión realizada al aplicar el cambio de fase condicional respecto del estado $\ket{u}$.'
    width='700'
    height='700'
  />
  <span style='width:455px; padding:10px 40px'>
    **Figura (4):** Reflexión realizada al aplicar el cambio de fase condicional respecto del estado $\ket{u}$.
  </span>
</div>

<div style='display:flex; justify-content:center; align-items:center; flex-direction:column'>
  <Image
    src={`${import.meta.env.BASE_URL}/grover/rotation.jpg`}
    alt='Rotación obtenida como producto de haber realizado ambas reflexiones, provocando un acercamiento hacia $\ket{A_1}$.'
    width='700'
    height='700'
  />
  <span style='width:455px; padding:10px 40px'>
    **Figura (5):** Rotación obtenida como producto de haber realizado ambas reflexiones, provocando un acercamiento hacia $\ket{A_1}$.
  </span>
</div>

*/}

## Ejemplos

Sea $x=0011$ la solución única al problema, se modifica el oráculo con una función que toma valor 1 únicamente con dicha cadena. Se sabe de antemano que el problema tiene una solución.

<Tabs>
  <TabItem label='Círculos'>
    <Box>
      Se analizan los pasos del algoritmo donde:
      - $\Gamma_0$ es el estado inicial $\ket{0}$
      - $\Gamma_1$ se corresponde con la preparación del estado cuántico que resulta en $\ket{\Psi}$
      - $\sigma$ representa el resultado de aplicar la operación de selección  
      - $\lambda$ es el efecto de la etapa de reflejo

      En $\sigma$ y $\lambda$ se utilizará como subíndice el número de iteración.

       La cantidad óptima de iteraciones es:
       ```math
        N_{iteraciones}=\left\lfloor \frac{\pi}{4}\sqrt{\frac{2^4}{1}} \right\rfloor=\lfloor \pi \rfloor = 3
       ```
       <div style='margin-top:30px'>
         <ResourceDivider icon='pencil' text='\(\Gamma_0\)' />
       </div>
       <div style='display: flex; flex-direction:column; align-items:center; margin-bottom:60px'>
        El estado inicial del algoritmo $\ket{0}^{\otimes 4}$
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={1} label={'\\ket{0000}'} />
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{0001}'} />
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{0010}'} />
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{0011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{0100}'} />
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{0101}'} />
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{0110}'} />
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{0111}'} />
            </div>
         </section>
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{1000}'} />
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{1001}'} />
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{1010}'} />
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{1011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{1100}'} />
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{1101}'} />
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{1110}'} />
              <Circle width={'80'} phase={'0'} prob={0} label={'\\ket{1111}'} />
            </div>
         </section>
       </div>
       <ResourceDivider icon='pencil' text='\(\Gamma_1\)' />
       <div style='display: flex; flex-direction:column; align-items:center; margin-bottom:60px'>
         Estado cuántico luego de la preparación (aplicación del algoritmo $\mathcal{A} = H$)
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0000}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0001}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0010}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0011}'} />
              </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0100}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0101}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0110}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0111}'} />
            </div>
         </section>
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1000}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1001}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1010}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1100}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1101}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1110}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1111}'} />
            </div>
         </section>
       </div>
       <ResourceDivider icon='pencil' text='\(\sigma_1\)' />
       <div style='display: flex; flex-direction:column; align-items:center; margin-bottom:60px'>
           Notar que $\ket{0011}$ tiene invertida la fase
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0000}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0001}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0010}'} />
              <Circle width={'80'} phase={'180'} prob={0.0625} label={'\\ket{0011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0100}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0101}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0110}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{0111}'} />
          </div>
         </section>
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1000}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1001}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1010}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1100}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1101}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1110}'} />
              <Circle width={'80'} phase={'0'} prob={0.0625} label={'\\ket{1111}'} />
            </div>
         </section>
       </div>
       <ResourceDivider icon='pencil' text='\(\lambda_1\)' />
       <div style='display: flex; flex-direction:column; align-items:center; margin-bottom:60px'>
         Notar la "deselección" de $\ket{0011}$
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{0000}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{0001}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{0010}'} />
              <Circle width={'80'} phase={'180'} prob={0.472656} label={'\\ket{0011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{0100}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{0101}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{0110}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{0111}'} />
         </div>
         </section>
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1000}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1001}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1010}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1100}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1101}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1110}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1111}'} />
            </div>
         </section>
       </div>
       <ResourceDivider icon='pencil' text='\(\sigma_2\)' />
       <div style='display: flex; flex-direction:column; align-items:center; margin-bottom:60px'>
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{0000}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{0001}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{0010}'} />
              <Circle width={'80'} phase={'0'} prob={0.472656} label={'\\ket{0011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{0100}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{0101}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{0110}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{0111}'} />
            </div>
         </section>
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1000}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1001}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1010}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1100}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1101}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1110}'} />
              <Circle width={'80'} phase={'180'} prob={0.035156} label={'\\ket{1111}'} />
            </div>
         </section>
       </div>
       <ResourceDivider icon='pencil' text='\(\lambda_2\)' />
       <div style='display: flex; flex-direction:column; align-items:center; margin-bottom:60px'>
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{0000}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{0001}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{0010}'} />
              <Circle width={'80'} phase={'0'} prob={0.908447} label={'\\ket{0011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{0100}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{0101}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{0110}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{0111}'} />
            </div>
         </section>
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1000}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1001}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1010}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1100}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1101}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1110}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1111}'} />
            </div>
         </section>
       </div>
       <ResourceDivider icon='pencil' text='\(\sigma_3\)' />
       <div style='display: flex; flex-direction:column; align-items:center; margin-bottom:60px'>
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{0000}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{0001}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{0010}'} />
              <Circle width={'80'} phase={'180'} prob={0.908447} label={'\\ket{0011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{0100}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{0101}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{0110}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{0111}'} />
            </div>
         </section>
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1000}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1001}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1010}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1100}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1101}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1110}'} />
              <Circle width={'80'} phase={'0'} prob={0.006104} label={'\\ket{1111}'} />
            </div>
         </section>
       </div>
       <ResourceDivider icon='pencil' text='\(\lambda_3\)' />
       <div style='display: flex; flex-direction:column; align-items:center; margin-bottom:60px'>
         Notar que no "deselecciona" ya que alcanzó la cantidad óptima de iteraciones.
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{0000}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{0001}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{0010}'} />
              <Circle width={'80'} phase={'180'} prob={0.961319} label={'\\ket{0011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{0100}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{0101}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{0110}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{0111}'} />
            </div>
         </section>
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1000}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1001}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1010}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1100}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1101}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1110}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1111}'} />
            </div>
         </section>
       </div>
       Llegados a este punto, el problema se encuentra **resuelto** con una probabilidad de 96.1319\%. Se realiza una cuarta iteración para mostrar el decremento de la probabilidad al exceder la cantidad óptima de iteraciones.
       <div style='margin-top:30px'>
       <ResourceDivider icon='pencil' text='\(\sigma_4\)' />
       </div>
       <div style='display: flex; flex-direction:column; align-items:center; margin-bottom:60px'>
         Notar que la operación de "selección" no logró distinguir al estado bueno.
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{0000}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{0001}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{0010}'} />
              <Circle width={'80'} phase={'0'} prob={0.961319} label={'\\ket{0011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{0100}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{0101}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{0110}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{0111}'} />
            </div>
         </section>
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1000}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1001}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1010}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1100}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1101}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1110}'} />
              <Circle width={'80'} phase={'0'} prob={0.002579} label={'\\ket{1111}'} />
            </div>
         </section>
       </div>
       <ResourceDivider icon='pencil' text='\(\lambda_4\)' />
       <div style='display: flex; flex-direction:column; align-items:center; margin-bottom:60px'>
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{0000}'} />
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{0001}'} />
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{0010}'} />
              <Circle width={'80'} phase={'0'} prob={0.581704} label={'\\ket{0011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{0100}'} />
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{0101}'} />
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{0110}'} />
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{0111}'} />
            </div>
         </section>
         <section class="responsive-circles">
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{1000}'} />
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{1001}'} />
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{1010}'} />
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{1011}'} />
            </div>
            <div class="quadrant-circles">
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{1100}'} />
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{1101}'} />
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{1110}'} />
              <Circle width={'80'} phase={'180'} prob={0.027886} label={'\\ket{1111}'} />
            </div>
         </section>
       </div>
       Por lo que en una cuarta iteración se disminuyen las probabilidades de encontrar el número buscado.
    </Box>
  </TabItem>
  <TabItem label='Quirk'>
    <Box>
      <QuantumCircuit src={quirk_example} />
      <Aside>
        El cubit más significativo (desde abajo hacia arriba en el circuito) es el auxiliar utilizado por el oráculo **O**, el cual permite seleccionar la solución $x$. Mientras tanto, **mirror** está diagramada como la etapa de reflejo de la Figura (1) del artículo de <a href={`${import.meta.env.BASE_URL}/primitives/amplitude-amplification`}>AA</a>.
      </Aside>
    </Box>
  </TabItem>
  <TabItem label='Qiskit'>
    <Box>
      <Tabs>
        <TabItem label='Código'>
          <Code code={qiskit_example} lang='py' />
        </TabItem>
        <TabItem label='Resultado'>
          <Code
            mark={[`{'11': 1024}`]}
            lang='text'
            code={qiskit_example_result}
          />
          <Aside>
            El orden de la evaluación (la última linea) es de abajo hacia
            arriba, por lo que el último bit representa el de arriba.
          </Aside>
        </TabItem>
      </Tabs>
    </Box>
  </TabItem>
</Tabs>

## Más información

<Recommendations />
<BibItem id="wong" rate="r" prefix="Capítulo 7.6.3, " />
<BibItem id="nielsen" rate="a" prefix="Capítulo 6, " />
<BibItem id="groverQiskit" rate="a" />
<BibItem id="groverQC" rate="o" />
<BibItem id="oreilly" rate="o" prefix="Capítulo 10, " />
